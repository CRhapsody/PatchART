nohup: ignoring input
[2023-07-12 15:21:44,205][INFO] 
===== lr0.005-weight_decay0.0001-kcoeff0.4-support_lossSmoothL1-accuracy_lossCE-rapair_radius0.1-2023-07-12-15-21-44 configuration =====
  exp_fn: test_goal_safety
  seed: None
  dom: deeppoly
  start_abs_cnt: 5000
  max_abs_cnt: 10000
  refine_top_k: 200
  tiny_width: 0.001
  lr: 0.005
  batch_size: 100
  min_epochs: 25
  max_epochs: 35
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: False
  quiet: False
  debug: False
  no_repair: False
  reassure_support_and_patch_combine: True
  repair_radius: 0.1
  weight_decay: 0.0001
  k_coeff: 0.4
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x7fbd1f2edc10>
  support_loss: SmoothL1Loss()
  sample_amount: 5000
  reset_params: False
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7fbd1f2edca0>
===== end of lr0.005-weight_decay0.0001-kcoeff0.4-support_lossSmoothL1-accuracy_lossCE-rapair_radius0.1-2023-07-12-15-21-44 configuration =====

[2023-07-12 15:21:44,205][INFO] ===== start repair ======
[2023-07-12 15:21:44,205][INFO] For pgd attack net
[2023-07-12 15:21:46,368][INFO] --Support network: --- SupportNet ---
Name: support network
Num layers: 5 (i.e. hidden + output, excluding input layer)
Input size: 32
Hidden sizes (len 4): [10, 10, 10, 10]
Output size: 10
Activation: deeppoly.ReLU()
last function: deeppoly.Sigmoid()
--- End of SupportNet ---
[2023-07-12 15:21:46,368][INFO] --Patch network: --- PatchNet ---
Name: patch network 9
Num layers: 5 (i.e. hidden + output, excluding input layer)
Input size: 32
Hidden sizes (len 4): [10, 10, 10, 10]
Output size: 10
Activation: deeppoly.ReLU()
--- End of PatchNet ---
[2023-07-12 15:21:46,369][INFO] start pre-training support network:
[2023-07-12 15:21:46,545][INFO] Epoch 1: support loss 0.05889232962941512
[2023-07-12 15:21:46,740][INFO] Epoch 2: support loss 0.044010803007926695
[2023-07-12 15:21:46,928][INFO] Epoch 3: support loss 0.037864287168933794
[2023-07-12 15:21:47,118][INFO] Epoch 4: support loss 0.035140431295029625
[2023-07-12 15:21:47,300][INFO] Epoch 5: support loss 0.032459505332204014
[2023-07-12 15:21:47,481][INFO] Epoch 6: support loss 0.03118907715170047
[2023-07-12 15:21:47,662][INFO] Epoch 7: support loss 0.03005291597965436
[2023-07-12 15:21:47,841][INFO] Epoch 8: support loss 0.0287876726868443
[2023-07-12 15:21:48,023][INFO] Epoch 9: support loss 0.02798106239583248
[2023-07-12 15:21:48,203][INFO] Epoch 10: support loss 0.027207175413003333
[2023-07-12 15:21:48,387][INFO] Epoch 11: support loss 0.026668326212809637
[2023-07-12 15:21:48,565][INFO] Epoch 12: support loss 0.026216354865867358
[2023-07-12 15:21:48,751][INFO] Epoch 13: support loss 0.025731804494101267
[2023-07-12 15:21:48,931][INFO] Epoch 14: support loss 0.02482019202449383
[2023-07-12 15:21:49,111][INFO] Epoch 15: support loss 0.02381277385239418
[2023-07-12 15:21:49,302][INFO] Epoch 16: support loss 0.023078864726882715
[2023-07-12 15:21:49,482][INFO] Epoch 17: support loss 0.022644101427151606
[2023-07-12 15:21:49,696][INFO] Epoch 18: support loss 0.02188409860126483
[2023-07-12 15:21:49,887][INFO] Epoch 19: support loss 0.021759981504426554
[2023-07-12 15:21:50,094][INFO] Epoch 20: support loss 0.021435981353697103
[2023-07-12 15:21:50,280][INFO] Epoch 21: support loss 0.021065952984663922
[2023-07-12 15:21:50,472][INFO] Epoch 22: support loss 0.020941683306143835
[2023-07-12 15:21:50,651][INFO] Epoch 23: support loss 0.02073404011435998
[2023-07-12 15:21:50,851][INFO] Epoch 24: support loss 0.020686281976313926
[2023-07-12 15:21:51,027][INFO] Epoch 25: support loss 0.020428081950507104
[2023-07-12 15:21:51,204][INFO] Epoch 26: support loss 0.020144060301857118
[2023-07-12 15:21:51,381][INFO] Epoch 27: support loss 0.020082544021977063
[2023-07-12 15:21:51,572][INFO] Epoch 28: support loss 0.019978572375690326
[2023-07-12 15:21:51,762][INFO] Epoch 29: support loss 0.019791084234244548
[2023-07-12 15:21:51,941][INFO] Epoch 30: support loss 0.0197145878456724
[2023-07-12 15:21:52,140][INFO] Epoch 31: support loss 0.019446998583869293
[2023-07-12 15:21:52,332][INFO] Epoch 32: support loss 0.0194210508862176
[2023-07-12 15:21:52,519][INFO] Epoch 33: support loss 0.019198082960568942
[2023-07-12 15:21:52,711][INFO] Epoch 34: support loss 0.01921353966761858
[2023-07-12 15:21:52,928][INFO] Epoch 35: support loss 0.019198676451849632
[2023-07-12 15:21:53,113][INFO] Epoch 36: support loss 0.018983568829030562
[2023-07-12 15:21:53,292][INFO] Epoch 37: support loss 0.01885177055373788
[2023-07-12 15:21:53,475][INFO] Epoch 38: support loss 0.0189136059787602
[2023-07-12 15:21:53,667][INFO] Epoch 39: support loss 0.018834108928552806
[2023-07-12 15:21:53,856][INFO] Epoch 40: support loss 0.01885599557023782
[2023-07-12 15:21:54,041][INFO] Epoch 41: support loss 0.018658914615232974
[2023-07-12 15:21:54,220][INFO] Epoch 42: support loss 0.01865683727635023
[2023-07-12 15:21:54,400][INFO] Epoch 43: support loss 0.018687923677647725
[2023-07-12 15:21:54,579][INFO] Epoch 44: support loss 0.018634905238659717
[2023-07-12 15:21:54,784][INFO] Epoch 45: support loss 0.018711547665775586
[2023-07-12 15:21:55,011][INFO] Epoch 46: support loss 0.018595188688964415
[2023-07-12 15:21:55,219][INFO] Epoch 47: support loss 0.018613020352159556
[2023-07-12 15:21:55,396][INFO] Epoch 48: support loss 0.018663010870416958
[2023-07-12 15:21:55,579][INFO] Epoch 49: support loss 0.018528337196375314
[2023-07-12 15:21:55,756][INFO] Epoch 50: support loss 0.01841077181056906
[2023-07-12 15:21:55,944][INFO] Epoch 51: support loss 0.018456436216067046
[2023-07-12 15:21:56,130][INFO] Epoch 52: support loss 0.01858480177963009
[2023-07-12 15:21:56,313][INFO] Epoch 53: support loss 0.018323862865471687
[2023-07-12 15:21:56,485][INFO] Epoch 54: support loss 0.01842408036240018
[2023-07-12 15:21:56,672][INFO] Epoch 55: support loss 0.018287823714602452
[2023-07-12 15:21:56,845][INFO] Epoch 56: support loss 0.018209516727484953
[2023-07-12 15:21:57,028][INFO] Epoch 57: support loss 0.018165653225225516
[2023-07-12 15:21:57,211][INFO] Epoch 58: support loss 0.018186071780152045
[2023-07-12 15:21:57,396][INFO] Epoch 59: support loss 0.018299550009079468
[2023-07-12 15:21:57,572][INFO] Epoch 60: support loss 0.018290505637056552
[2023-07-12 15:21:57,748][INFO] Epoch 61: support loss 0.01804864829262862
[2023-07-12 15:21:57,933][INFO] Epoch 62: support loss 0.01810357341160759
[2023-07-12 15:21:58,116][INFO] Epoch 63: support loss 0.0181514003003637
[2023-07-12 15:21:58,307][INFO] Epoch 64: support loss 0.01813911957045396
[2023-07-12 15:21:58,498][INFO] Epoch 65: support loss 0.018073738337709352
[2023-07-12 15:21:58,500][INFO] test support net accuracy: 0.7400735294117647
/home/chizm/PatchART/art/bisecter.py:491: UserWarning: where received a uint8 condition tensor. This behavior is deprecated and will be removed in a future version of PyTorch. Use a boolean condition instead. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525541702/work/aten/src/ATen/native/TensorCompare.cpp:413.)
  lefts_ub = torch.where(onehot_idxs, mid, ub)
[2023-07-12 16:13:46,567][INFO] [0m 0s (0.459 seconds)] After epoch 0:
[2023-07-12 16:13:46,567][INFO] Loaded 10000 points for training.
[2023-07-12 16:13:46,568][INFO] Loaded 5000 abstractions for training.
[2023-07-12 16:13:46,639][INFO] min loss 20.455360412597656, max loss 93.25768280029297.
[2023-07-12 16:13:46,641][INFO] Max loss at LB: tensor([-0.1000,  3.2446, -0.1000,  1.9968,  2.8812, -0.1000,  1.9375, -0.1000,
         4.5734,  7.4585, -0.1000, -0.1000, -0.1000,  5.6202, -0.1000,  0.5609,
         4.6088,  0.6613,  1.9512, 13.9180,  0.8633,  2.5232,  8.3979,  1.6853,
         3.6660, -0.1000,  1.6853, -0.0500,  2.1662, -0.1000, -0.1000, -0.1000],
       device='cuda:0'), UB: tensor([ 0.1000,  3.3446,  0.0000,  2.0968,  3.0812,  0.1000,  2.1375,  0.1000,
         4.6734,  7.5085,  0.0000,  0.0000,  0.1000,  5.8202,  0.1000,  0.6609,
         4.7088,  0.7613,  2.1512, 14.0180,  0.9633,  2.5732,  8.4979,  1.7853,
         3.7660,  0.1000,  1.7853,  0.0500,  2.3662,  0.1000,  0.1000,  0.1000],
       device='cuda:0'), rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:13:46,651][INFO] Test set accuracy 0.06286764705882353.
[2023-07-12 16:13:46,652][INFO] Train set accuracy 0.0653.
[2023-07-12 16:13:46,652][INFO] 
[0m 0s (0.543 seconds)] Starting epoch 1:
[2023-07-12 16:14:08,603][INFO] [0m 22s (22.494 seconds)] At epoch 1: avg accuracy training loss 18.508127068188042.
[2023-07-12 16:14:14,789][INFO] [0m 28s (28.680 seconds)] After epoch 1:
[2023-07-12 16:14:14,790][INFO] Loaded 10000 points for training.
[2023-07-12 16:14:14,791][INFO] Loaded 5381 abstractions for training.
[2023-07-12 16:14:14,907][INFO] min loss 0.0, max loss 10.105319023132324.
[2023-07-12 16:14:14,909][INFO] Max loss at LB: tensor([-0.1000,  0.2158,  7.6627,  3.8031, -0.1000,  0.0827,  3.8904, -0.1000,
        -0.1000, -0.1000,  0.9283,  2.7127, -0.1000, -0.1000,  2.6712, -0.1000,
        -0.1000, -0.1000,  2.8883,  0.8624,  2.0275,  3.9516,  2.6137, -0.1000,
        -0.1000,  0.0000,  0.0731, -0.1000, -0.1000,  1.1971,  6.2599, -0.1000],
       device='cuda:0'), UB: tensor([0.1000, 0.3158, 7.8627, 3.9031, 0.1000, 0.2827, 4.0904, 0.1000, 0.1000,
        0.1000, 1.1283, 2.9127, 0.1000, 0.1000, 2.8712, 0.1000, 0.1000, 0.1000,
        3.0883, 1.0624, 2.2275, 4.1516, 2.7137, 0.1000, 0.1000, 0.1000, 0.1731,
        0.1000, 0.0000, 1.3971, 6.3599, 0.1000], device='cuda:0'), rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 1], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:14:14,918][INFO] Test set accuracy 0.6227941176470588.
[2023-07-12 16:14:14,919][INFO] Train set accuracy 0.6147.
[2023-07-12 16:14:14,919][INFO] 
[0m 28s (28.810 seconds)] Starting epoch 2:
[2023-07-12 16:14:37,105][INFO] [0m 50s (50.996 seconds)] At epoch 2: avg accuracy training loss 0.011534017398953439.
[2023-07-12 16:14:41,890][INFO] [0m 55s (55.782 seconds)] After epoch 2:
[2023-07-12 16:14:41,892][INFO] Loaded 10000 points for training.
[2023-07-12 16:14:41,892][INFO] Loaded 5381 abstractions for training.
[2023-07-12 16:14:41,997][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:14:41,998][INFO] All 5381 abstractions certified.
[2023-07-12 16:14:42,011][INFO] Test set accuracy 0.6610294117647059.
[2023-07-12 16:14:42,012][INFO] Train set accuracy 0.6565.
[2023-07-12 16:14:42,012][INFO] 
[0m 55s (55.903 seconds)] Starting epoch 3:
[2023-07-12 16:15:03,525][INFO] [1m 17s (77.416 seconds)] At epoch 3: avg accuracy training loss 0.000832614260725677.
[2023-07-12 16:15:10,078][INFO] [1m 23s (83.969 seconds)] After epoch 3:
[2023-07-12 16:15:10,080][INFO] Loaded 10000 points for training.
[2023-07-12 16:15:10,080][INFO] Loaded 5635 abstractions for training.
[2023-07-12 16:15:10,211][INFO] min loss 0.0, max loss 7.1178975105285645.
[2023-07-12 16:15:10,217][INFO] Max loss at LB: tensor([-0.1000,  1.0000,  1.3494, -0.1000,  5.5595, -0.1000, -0.1000,  2.4061,
        -0.1000,  0.0930, -0.1000, -0.1000, -0.1000,  9.9124, -0.1000,  0.6187,
         2.2022, -0.1000, -0.1000, -0.1000,  3.0573, -0.1000, -0.1000,  8.4437,
         2.5661,  3.0753, -0.1000,  3.7773,  4.4149,  0.5168, -0.1000,  1.9151],
       device='cuda:0'), UB: tensor([ 0.1000,  1.1000,  1.4494,  0.0000,  5.7595,  0.1000,  0.0000,  2.6061,
         0.1000,  0.2930,  0.1000,  0.1000,  0.1000, 10.1124,  0.0000,  0.8187,
         2.4022,  0.1000,  0.1000,  0.1000,  3.2573,  0.1000,  0.1000,  8.6437,
         2.7661,  3.2753,  0.1000,  3.9773,  4.6149,  0.7168,  0.0000,  2.0151],
       device='cuda:0'), rule: tensor([0, 0, 0, 0, 1, 0, 0, 0, 0, 0], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:15:10,232][INFO] Test set accuracy 0.6680147058823529.
[2023-07-12 16:15:10,232][INFO] Train set accuracy 0.6692.
[2023-07-12 16:15:10,232][INFO] 
[1m 24s (84.124 seconds)] Starting epoch 4:
[2023-07-12 16:15:33,213][INFO] [1m 47s (107.105 seconds)] At epoch 4: avg accuracy training loss 0.0029037697077728807.
[2023-07-12 16:15:38,950][INFO] [1m 52s (112.842 seconds)] After epoch 4:
[2023-07-12 16:15:38,952][INFO] Loaded 10000 points for training.
[2023-07-12 16:15:38,953][INFO] Loaded 5635 abstractions for training.
[2023-07-12 16:15:39,040][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:15:39,041][INFO] All 5635 abstractions certified.
[2023-07-12 16:15:39,050][INFO] Test set accuracy 0.68125.
[2023-07-12 16:15:39,051][INFO] Train set accuracy 0.6889.
[2023-07-12 16:15:39,051][INFO] 
[1m 52s (112.942 seconds)] Starting epoch 5:
[2023-07-12 16:16:01,838][INFO] [2m 15s (135.730 seconds)] At epoch 5: avg accuracy training loss 0.000695349401794374.
[2023-07-12 16:16:07,275][INFO] [2m 21s (141.166 seconds)] After epoch 5:
[2023-07-12 16:16:07,276][INFO] Loaded 10000 points for training.
[2023-07-12 16:16:07,277][INFO] Loaded 5635 abstractions for training.
[2023-07-12 16:16:07,349][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:16:07,350][INFO] All 5635 abstractions certified.
[2023-07-12 16:16:07,361][INFO] Test set accuracy 0.7058823529411765.
[2023-07-12 16:16:07,361][INFO] Train set accuracy 0.7166.
[2023-07-12 16:16:07,361][INFO] 
[2m 21s (141.253 seconds)] Starting epoch 6:
[2023-07-12 16:16:29,172][INFO] [2m 43s (163.064 seconds)] At epoch 6: avg accuracy training loss 0.0014077294943854212.
[2023-07-12 16:16:34,808][INFO] [2m 48s (168.700 seconds)] After epoch 6:
[2023-07-12 16:16:34,809][INFO] Loaded 10000 points for training.
[2023-07-12 16:16:34,810][INFO] Loaded 5635 abstractions for training.
[2023-07-12 16:16:34,924][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:16:34,924][INFO] All 5635 abstractions certified.
[2023-07-12 16:16:34,933][INFO] Test set accuracy 0.7422794117647059.
[2023-07-12 16:16:34,934][INFO] Train set accuracy 0.7616.
[2023-07-12 16:16:34,934][INFO] 
[2m 48s (168.826 seconds)] Starting epoch 7:
[2023-07-12 16:16:57,122][INFO] [3m 11s (191.014 seconds)] At epoch 7: avg accuracy training loss 0.0017201000824570655.
[2023-07-12 16:17:02,775][INFO] [3m 16s (196.665 seconds)] After epoch 7:
[2023-07-12 16:17:02,782][INFO] Loaded 10000 points for training.
[2023-07-12 16:17:02,782][INFO] Loaded 5635 abstractions for training.
[2023-07-12 16:17:02,889][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:17:02,890][INFO] All 5635 abstractions certified.
[2023-07-12 16:17:02,902][INFO] Test set accuracy 0.7496323529411765.
[2023-07-12 16:17:02,902][INFO] Train set accuracy 0.7738.
[2023-07-12 16:17:02,902][INFO] 
[3m 16s (196.793 seconds)] Starting epoch 8:
[2023-07-12 16:17:24,684][INFO] [3m 38s (218.575 seconds)] At epoch 8: avg accuracy training loss 0.0022256744652986524.
[2023-07-12 16:17:31,223][INFO] [3m 45s (225.114 seconds)] After epoch 8:
[2023-07-12 16:17:31,224][INFO] Loaded 10000 points for training.
[2023-07-12 16:17:31,224][INFO] Loaded 5890 abstractions for training.
[2023-07-12 16:17:31,399][INFO] min loss 0.0, max loss 3.198975086212158.
[2023-07-12 16:17:31,401][INFO] Max loss at LB: tensor([-0.1000, -0.1000, -0.0679,  4.1133,  6.2198, -0.1000,  0.5084,  0.0000,
        -0.1000,  1.1161,  4.0994,  0.6105, -0.1000, -0.1000,  9.2338,  2.1165,
        -0.1000, -0.1000, -0.1000, -0.0225,  0.9965,  6.5596,  2.0552,  4.0030,
         6.0504,  0.4287,  4.5058, -0.1000, -0.1000,  2.6488, -0.1000,  1.0785],
       device='cuda:0'), UB: tensor([0.1000, 0.0000, 0.1321, 4.3133, 6.4198, 0.1000, 0.7084, 0.1000, 0.0000,
        1.3161, 4.2994, 0.8105, 0.1000, 0.0000, 9.4338, 2.3165, 0.1000, 0.1000,
        0.1000, 0.0775, 1.0965, 6.7596, 2.1552, 4.2030, 6.2504, 0.6287, 4.7058,
        0.1000, 0.0000, 2.8488, 0.1000, 1.2785], device='cuda:0'), rule: tensor([0, 0, 0, 0, 0, 1, 0, 0, 0, 0], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:17:31,411][INFO] Test set accuracy 0.75.
[2023-07-12 16:17:31,411][INFO] Train set accuracy 0.7791.
[2023-07-12 16:17:31,411][INFO] 
[3m 45s (225.303 seconds)] Starting epoch 9:
[2023-07-12 16:17:53,320][INFO] [4m 7s (247.211 seconds)] At epoch 9: avg accuracy training loss 0.0011812676093541086.
[2023-07-12 16:18:00,997][INFO] [4m 14s (254.889 seconds)] After epoch 9:
[2023-07-12 16:18:00,999][INFO] Loaded 10000 points for training.
[2023-07-12 16:18:00,999][INFO] Loaded 6145 abstractions for training.
[2023-07-12 16:18:01,080][INFO] min loss 0.0, max loss 5.078433990478516.
[2023-07-12 16:18:01,088][INFO] Max loss at LB: tensor([-0.1000,  2.1905, -0.1000, -0.1000, -0.1000,  2.7251, -0.1000, -0.1000,
         1.0218,  2.9974, -0.1000,  0.6860, -0.1000,  8.3354, -0.1000,  1.9292,
         5.2453, -0.1000,  2.6778,  4.6896,  1.8035, -0.1000,  3.8911,  4.8717,
         1.4731, -0.1000, -0.1000,  3.6758,  4.9125,  0.8165, -0.1000,  0.0000],
       device='cuda:0'), UB: tensor([0.1000, 2.3905, 0.1000, 0.0000, 0.1000, 2.9251, 0.0000, 0.1000, 1.1218,
        3.1974, 0.1000, 0.8860, 0.1000, 8.5354, 0.1000, 2.1292, 5.4453, 0.1000,
        2.8778, 4.8896, 2.0035, 0.0000, 4.0911, 5.0717, 1.5731, 0.1000, 0.1000,
        3.7758, 5.1125, 1.0165, 0.0000, 0.1000], device='cuda:0'), rule: tensor([0, 0, 0, 0, 0, 1, 0, 0, 0, 0], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:18:01,097][INFO] Test set accuracy 0.7584558823529411.
[2023-07-12 16:18:01,097][INFO] Train set accuracy 0.7767.
[2023-07-12 16:18:01,098][INFO] 
[4m 14s (254.989 seconds)] Starting epoch 10:
[2023-07-12 16:18:23,960][INFO] [4m 37s (277.851 seconds)] At epoch 10: avg accuracy training loss 0.004089406095445156.
[2023-07-12 16:18:34,628][INFO] [4m 48s (288.520 seconds)] After epoch 10:
[2023-07-12 16:18:34,629][INFO] Loaded 10000 points for training.
[2023-07-12 16:18:34,629][INFO] Loaded 6176 abstractions for training.
[2023-07-12 16:18:34,718][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:18:34,718][INFO] All 6176 abstractions certified.
[2023-07-12 16:18:34,728][INFO] Test set accuracy 0.7672794117647059.
[2023-07-12 16:18:34,728][INFO] Train set accuracy 0.7945.
[2023-07-12 16:18:34,728][INFO] 
[4m 48s (288.619 seconds)] Starting epoch 11:
[2023-07-12 16:18:57,317][INFO] [5m 11s (311.208 seconds)] At epoch 11: avg accuracy training loss 0.0010495535715017467.
[2023-07-12 16:19:02,911][INFO] [5m 16s (316.802 seconds)] After epoch 11:
[2023-07-12 16:19:02,912][INFO] Loaded 10000 points for training.
[2023-07-12 16:19:02,913][INFO] Loaded 6176 abstractions for training.
[2023-07-12 16:19:03,013][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:19:03,014][INFO] All 6176 abstractions certified.
[2023-07-12 16:19:03,024][INFO] Test set accuracy 0.7691176470588236.
[2023-07-12 16:19:03,024][INFO] Train set accuracy 0.7924.
[2023-07-12 16:19:03,024][INFO] 
[5m 16s (316.916 seconds)] Starting epoch 12:
[2023-07-12 16:19:25,889][INFO] [5m 39s (339.780 seconds)] At epoch 12: avg accuracy training loss 0.001674257004633546.
[2023-07-12 16:19:31,750][INFO] [5m 45s (345.641 seconds)] After epoch 12:
[2023-07-12 16:19:31,751][INFO] Loaded 10000 points for training.
[2023-07-12 16:19:31,752][INFO] Loaded 6176 abstractions for training.
[2023-07-12 16:19:31,831][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:19:31,831][INFO] All 6176 abstractions certified.
[2023-07-12 16:19:31,840][INFO] Test set accuracy 0.7713235294117647.
[2023-07-12 16:19:31,841][INFO] Train set accuracy 0.8011.
[2023-07-12 16:19:31,841][INFO] 
[5m 45s (345.733 seconds)] Starting epoch 13:
[2023-07-12 16:19:54,374][INFO] [6m 8s (368.265 seconds)] At epoch 13: avg accuracy training loss 0.0017622456327080727.
[2023-07-12 16:20:00,095][INFO] [6m 13s (373.987 seconds)] After epoch 13:
[2023-07-12 16:20:00,097][INFO] Loaded 10000 points for training.
[2023-07-12 16:20:00,098][INFO] Loaded 6176 abstractions for training.
[2023-07-12 16:20:00,173][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:20:00,174][INFO] All 6176 abstractions certified.
[2023-07-12 16:20:00,183][INFO] Test set accuracy 0.7735294117647059.
[2023-07-12 16:20:00,183][INFO] Train set accuracy 0.7997.
[2023-07-12 16:20:00,184][INFO] 
[6m 14s (374.075 seconds)] Starting epoch 14:
[2023-07-12 16:20:22,858][INFO] [6m 36s (396.750 seconds)] At epoch 14: avg accuracy training loss 0.0021116324234753845.
[2023-07-12 16:20:30,108][INFO] [6m 43s (403.999 seconds)] After epoch 14:
[2023-07-12 16:20:30,109][INFO] Loaded 10000 points for training.
[2023-07-12 16:20:30,109][INFO] Loaded 6431 abstractions for training.
[2023-07-12 16:20:30,200][INFO] min loss 0.0, max loss 7.553748607635498.
[2023-07-12 16:20:30,203][INFO] Max loss at LB: tensor([-0.1000,  2.3821,  9.1519,  6.4781, -0.1000, -0.1000,  3.8229,  0.1959,
        -0.1000, -0.1000,  1.4734, -0.1000, -0.1000,  1.4532, -0.1000,  0.2029,
        -0.1000, -0.1000, -0.1000, -0.1000,  4.4989,  0.6288,  5.4672,  3.8291,
         4.3639,  0.8312,  1.5882, -0.1000,  1.3450,  0.3490,  2.5157,  0.2669],
       device='cuda:0'), UB: tensor([ 0.1000,  2.5821,  9.3519,  6.6781,  0.0000,  0.1000,  4.0229,  0.3959,
         0.1000,  0.1000,  1.6734, -0.0500,  0.1000,  1.6532,  0.0000,  0.4029,
         0.1000,  0.1000,  0.1000,  0.1000,  4.6989,  0.8288,  5.6672,  4.0291,
         4.5639,  0.9312,  1.7882,  0.1000,  1.4450,  0.5490,  2.6157,  0.3669],
       device='cuda:0'), rule: tensor([0, 0, 0, 0, 0, 0, 0, 1, 0, 0], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:20:30,212][INFO] Test set accuracy 0.7768382352941177.
[2023-07-12 16:20:30,213][INFO] Train set accuracy 0.8019.
[2023-07-12 16:20:30,213][INFO] 
[6m 44s (404.104 seconds)] Starting epoch 15:
[2023-07-12 16:20:51,372][INFO] [7m 5s (425.264 seconds)] At epoch 15: avg accuracy training loss 0.0021009619534015657.
[2023-07-12 16:20:59,346][INFO] [7m 13s (433.237 seconds)] After epoch 15:
[2023-07-12 16:20:59,348][INFO] Loaded 10000 points for training.
[2023-07-12 16:20:59,349][INFO] Loaded 6686 abstractions for training.
[2023-07-12 16:20:59,493][INFO] min loss 0.0, max loss 8.319366455078125.
[2023-07-12 16:20:59,496][INFO] Max loss at LB: tensor([-0.1000,  0.7333,  1.8783,  8.9712,  1.1321,  0.0000, -0.1000, -0.1000,
        -0.1000,  8.9154,  3.7293, -0.1000, -0.1000, -0.1000,  1.0101,  5.3181,
         2.1917, -0.1000, -0.1000,  1.7605,  5.4637,  6.8366,  7.9285, -0.1000,
        14.5585,  1.7265, -0.1000,  3.1308, -0.1000,  4.2537, -0.1000,  0.2769],
       device='cuda:0'), UB: tensor([ 0.1000,  0.9333,  2.0783,  9.1712,  1.3321,  0.1000,  0.1000,  0.0000,
         0.1000,  9.1154,  3.9293,  0.0000,  0.1000,  0.1000,  1.1101,  5.4181,
         2.3917,  0.1000,  0.1000,  1.9605,  5.6637,  7.0366,  8.1285,  0.1000,
        14.6585,  1.9265,  0.0000,  3.3308,  0.1000,  4.4537,  0.0000,  0.4769],
       device='cuda:0'), rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 1], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:20:59,512][INFO] Test set accuracy 0.7738970588235294.
[2023-07-12 16:20:59,513][INFO] Train set accuracy 0.7973.
[2023-07-12 16:20:59,513][INFO] 
[7m 13s (433.404 seconds)] Starting epoch 16:
[2023-07-12 16:21:21,716][INFO] [7m 35s (455.608 seconds)] At epoch 16: avg accuracy training loss 0.003844649475067854.
[2023-07-12 16:21:28,052][INFO] [7m 41s (461.943 seconds)] After epoch 16:
[2023-07-12 16:21:28,053][INFO] Loaded 10000 points for training.
[2023-07-12 16:21:28,054][INFO] Loaded 6686 abstractions for training.
[2023-07-12 16:21:28,155][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:21:28,155][INFO] All 6686 abstractions certified.
[2023-07-12 16:21:28,165][INFO] Test set accuracy 0.7797794117647059.
[2023-07-12 16:21:28,165][INFO] Train set accuracy 0.8133.
[2023-07-12 16:21:28,165][INFO] 
[7m 42s (462.057 seconds)] Starting epoch 17:
[2023-07-12 16:21:50,185][INFO] [8m 4s (484.076 seconds)] At epoch 17: avg accuracy training loss 0.005045109540224075.
[2023-07-12 16:21:57,661][INFO] [8m 11s (491.552 seconds)] After epoch 17:
[2023-07-12 16:21:57,661][INFO] Loaded 10000 points for training.
[2023-07-12 16:21:57,661][INFO] Loaded 7009 abstractions for training.
[2023-07-12 16:21:57,761][INFO] min loss 0.0, max loss 10.497102737426758.
[2023-07-12 16:21:57,763][INFO] Max loss at LB: tensor([-0.1000,  0.3954,  1.6741,  0.7982,  2.3329, -0.1000,  3.0193,  4.5244,
         0.1518,  0.6212,  6.2755, -0.1000, -0.1000, -0.1000,  4.9111, -0.1000,
        -0.1000, -0.1000, -0.1000, -0.1000,  1.9111, -0.1000,  4.1289,  5.7685,
         1.8215,  0.9283,  5.6926, -0.1000, -0.1000, -0.1000,  5.9422,  2.1703],
       device='cuda:0'), UB: tensor([0.1000, 0.4954, 1.8741, 0.8982, 2.5329, 0.1000, 3.2193, 4.6244, 0.2518,
        0.8212, 6.4755, 0.1000, 0.1000, 0.0000, 5.1111, 0.1000, 0.1000, 0.1000,
        0.1000, 0.0000, 2.1111, 0.1000, 4.3289, 5.9685, 2.0215, 1.1283, 5.8926,
        0.1000, 0.0000, 0.1000, 6.1422, 2.3703], device='cuda:0'), rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 1], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:21:57,772][INFO] Test set accuracy 0.7841911764705882.
[2023-07-12 16:21:57,773][INFO] Train set accuracy 0.8094.
[2023-07-12 16:21:57,773][INFO] 
[8m 11s (491.664 seconds)] Starting epoch 18:
[2023-07-12 16:22:20,248][INFO] [8m 34s (514.139 seconds)] At epoch 18: avg accuracy training loss 0.0026821793615818025.
[2023-07-12 16:22:28,722][INFO] [8m 42s (522.613 seconds)] After epoch 18:
[2023-07-12 16:22:28,723][INFO] Loaded 10000 points for training.
[2023-07-12 16:22:28,723][INFO] Loaded 7264 abstractions for training.
[2023-07-12 16:22:28,818][INFO] min loss 0.0, max loss 28.32892608642578.
[2023-07-12 16:22:28,823][INFO] Max loss at LB: tensor([-0.1000,  0.8065, -0.0814, -0.1000,  1.8681,  1.2247,  6.1679,  4.1987,
        -0.1000,  0.9228,  8.2519, -0.1000, -0.1000, -0.1000,  4.5331, -0.1000,
        -0.1000, -0.1000,  2.0722, -0.1000,  6.8234,  3.9635,  0.8647,  0.0449,
         5.4025,  1.2935, -0.1000,  3.0020, -0.1000,  0.9418, -0.1000, -0.1000],
       device='cuda:0'), UB: tensor([ 0.1000,  0.9065,  0.1186,  0.1000,  1.9681,  1.4247,  6.3679,  4.2987,
         0.1000,  1.1228,  8.4519,  0.1000,  0.1000,  0.1000,  4.7331,  0.1000,
         0.1000,  0.1000,  2.1722,  0.1000,  7.0234,  4.0635,  1.0647,  0.2449,
         5.6025,  1.4935, -0.0500,  3.2020,  0.1000,  1.0418,  0.1000,  0.1000],
       device='cuda:0'), rule: tensor([0, 1, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:22:28,832][INFO] Test set accuracy 0.7911764705882353.
[2023-07-12 16:22:28,833][INFO] Train set accuracy 0.8199.
[2023-07-12 16:22:28,833][INFO] 
[8m 42s (522.724 seconds)] Starting epoch 19:
[2023-07-12 16:22:51,953][INFO] [9m 5s (545.844 seconds)] At epoch 19: avg accuracy training loss 0.007680678053293377.
[2023-07-12 16:22:59,018][INFO] [9m 12s (552.910 seconds)] After epoch 19:
[2023-07-12 16:22:59,019][INFO] Loaded 10000 points for training.
[2023-07-12 16:22:59,021][INFO] Loaded 7264 abstractions for training.
[2023-07-12 16:22:59,112][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:22:59,112][INFO] All 7264 abstractions certified.
[2023-07-12 16:22:59,133][INFO] Test set accuracy 0.7897058823529411.
[2023-07-12 16:22:59,134][INFO] Train set accuracy 0.8241.
[2023-07-12 16:22:59,134][INFO] 
[9m 13s (553.026 seconds)] Starting epoch 20:
[2023-07-12 16:23:21,439][INFO] [9m 35s (575.330 seconds)] At epoch 20: avg accuracy training loss 0.0012893661484122277.
[2023-07-12 16:23:30,165][INFO] [9m 44s (584.057 seconds)] After epoch 20:
[2023-07-12 16:23:30,166][INFO] Loaded 10000 points for training.
[2023-07-12 16:23:30,166][INFO] Loaded 7300 abstractions for training.
[2023-07-12 16:23:30,251][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:23:30,251][INFO] All 7300 abstractions certified.
[2023-07-12 16:23:30,261][INFO] Test set accuracy 0.7922794117647058.
[2023-07-12 16:23:30,261][INFO] Train set accuracy 0.8185.
[2023-07-12 16:23:30,261][INFO] 
[9m 44s (584.152 seconds)] Starting epoch 21:
[2023-07-12 16:23:53,051][INFO] [10m 6s (606.943 seconds)] At epoch 21: avg accuracy training loss 0.0006197172775864601.
[2023-07-12 16:24:02,417][INFO] [10m 16s (616.308 seconds)] After epoch 21:
[2023-07-12 16:24:02,418][INFO] Loaded 10000 points for training.
[2023-07-12 16:24:02,418][INFO] Loaded 7603 abstractions for training.
[2023-07-12 16:24:02,575][INFO] min loss 0.0, max loss 3.859069347381592.
[2023-07-12 16:24:02,578][INFO] Max loss at LB: tensor([-0.1000,  1.2003, -0.1000, -0.1000,  5.5507,  0.0000,  1.1806,  0.4223,
        -0.1000,  1.9025,  5.4344, -0.1000, -0.1000,  1.4475,  1.9505, -0.1000,
        -0.1000, -0.1000,  0.0000,  0.4121,  5.1816, -0.1000,  1.1751,  2.1275,
         6.1575,  2.9823,  1.2086, -0.1000, -0.1000, -0.1000, -0.0758,  0.9617],
       device='cuda:0'), UB: tensor([0.1000, 1.4003, 0.1000, 0.0000, 5.7507, 0.1000, 1.3806, 0.6223, 0.1000,
        2.1025, 5.6344, 0.1000, 0.1000, 1.6475, 2.1505, 0.0000, 0.1000, 0.1000,
        0.1000, 0.6121, 5.3816, 0.0000, 1.3751, 2.3275, 6.3575, 3.1823, 1.3086,
        0.1000, 0.0000, 0.1000, 0.0242, 1.0117], device='cuda:0'), rule: tensor([0, 1, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0', dtype=torch.uint8).
[2023-07-12 16:24:02,588][INFO] Test set accuracy 0.8029411764705883.
[2023-07-12 16:24:02,588][INFO] Train set accuracy 0.8386.
[2023-07-12 16:24:02,589][INFO] 
[10m 16s (616.480 seconds)] Starting epoch 22:
[2023-07-12 16:24:24,513][INFO] [10m 38s (638.404 seconds)] At epoch 22: avg accuracy training loss 0.0003026281238999218.
[2023-07-12 16:24:31,507][INFO] [10m 45s (645.398 seconds)] After epoch 22:
[2023-07-12 16:24:31,508][INFO] Loaded 10000 points for training.
[2023-07-12 16:24:31,510][INFO] Loaded 7603 abstractions for training.
[2023-07-12 16:24:31,654][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:24:31,655][INFO] All 7603 abstractions certified.
[2023-07-12 16:24:31,665][INFO] Test set accuracy 0.8003676470588236.
[2023-07-12 16:24:31,668][INFO] Train set accuracy 0.833.
[2023-07-12 16:24:31,668][INFO] 
[10m 45s (645.559 seconds)] Starting epoch 23:
[2023-07-12 16:24:54,515][INFO] [11m 8s (668.406 seconds)] At epoch 23: avg accuracy training loss 0.0018776453065220266.
[2023-07-12 16:25:02,136][INFO] [11m 16s (676.028 seconds)] After epoch 23:
[2023-07-12 16:25:02,141][INFO] Loaded 10000 points for training.
[2023-07-12 16:25:02,141][INFO] Loaded 7603 abstractions for training.
[2023-07-12 16:25:02,233][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:25:02,233][INFO] All 7603 abstractions certified.
[2023-07-12 16:25:02,250][INFO] Test set accuracy 0.8018382352941177.
[2023-07-12 16:25:02,250][INFO] Train set accuracy 0.8399.
[2023-07-12 16:25:02,250][INFO] 
[11m 16s (676.142 seconds)] Starting epoch 24:
[2023-07-12 16:25:25,149][INFO] [11m 39s (699.040 seconds)] At epoch 24: avg accuracy training loss 0.0019779025204479696.
[2023-07-12 16:25:32,760][INFO] [11m 46s (706.651 seconds)] After epoch 24:
[2023-07-12 16:25:32,761][INFO] Loaded 10000 points for training.
[2023-07-12 16:25:32,762][INFO] Loaded 7603 abstractions for training.
[2023-07-12 16:25:32,887][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:25:32,888][INFO] All 7603 abstractions certified.
[2023-07-12 16:25:32,897][INFO] Test set accuracy 0.8091911764705882.
[2023-07-12 16:25:32,898][INFO] Train set accuracy 0.8449.
[2023-07-12 16:25:32,898][INFO] 
[11m 46s (706.789 seconds)] Starting epoch 25:
[2023-07-12 16:25:55,191][INFO] [12m 9s (729.082 seconds)] At epoch 25: avg accuracy training loss 0.00034154132707044484.
[2023-07-12 16:26:02,047][INFO] [12m 15s (735.938 seconds)] After epoch 25:
[2023-07-12 16:26:02,049][INFO] Loaded 10000 points for training.
[2023-07-12 16:26:02,050][INFO] Loaded 7603 abstractions for training.
[2023-07-12 16:26:02,139][INFO] min loss 0.0, max loss 0.0.
[2023-07-12 16:26:02,140][INFO] All 7603 abstractions certified.
[2023-07-12 16:26:02,151][INFO] Test set accuracy 0.8161764705882353.
[2023-07-12 16:26:02,151][INFO] Train set accuracy 0.8529.
[2023-07-12 16:26:02,152][INFO] Accuracy at every epoch: [0.06286764705882353, 0.6227941176470588, 0.6610294117647059, 0.6680147058823529, 0.68125, 0.7058823529411765, 0.7422794117647059, 0.7496323529411765, 0.75, 0.7584558823529411, 0.7672794117647059, 0.7691176470588236, 0.7713235294117647, 0.7735294117647059, 0.7768382352941177, 0.7738970588235294, 0.7797794117647059, 0.7841911764705882, 0.7911764705882353, 0.7897058823529411, 0.7922794117647058, 0.8029411764705883, 0.8003676470588236, 0.8018382352941177, 0.8091911764705882, 0.8161764705882353]
[2023-07-12 16:26:02,152][INFO] After 25 epochs / 12m 16s (736.043 seconds), eventually the trained network got certified? True, with 0.8162 accuracy on test set.
[2023-07-12 16:26:02,160][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2023-07-12 16:26:02,162][INFO] tensor([ 25.0000, 736.0431,   1.0000,   0.8162])
[2023-07-12 16:26:02,171][INFO] Total Cost Time: 3857.966395802796s.



Traceback (most recent call last):
  File "art/exp_mnist.py", line 626, in <module>
    test(lr=lr, weight_decay=weight_decay, k_coeff=k_coeff, repair_radius=0.1, support_loss=support_loss, accuracy_loss=accuracy_loss)
  File "art/exp_mnist.py", line 612, in test
    exp_fn(parser)
  File "art/exp_mnist.py", line 529, in test_goal_safety
    args = parser.parse_args()
  File "/home/chizm/PatchART/art/exp.py", line 154, in parse_args
    self.setup_rest(res)
  File "art/exp_mnist.py", line 90, in setup_rest
    args.support_loss = {
KeyError: 'MSE'
